!function(e,t,n,i){e.extend({inherit:function(n,i,s){n.prototype=t.create(i.prototype),n.prototype.constructor=n,e.extend(n.prototype,s)}});var s={ENTER:13,ESC:27},l=function(e){var t=n.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,n){return t[n]!==i?t[n]:e})},c=function(e){this.el=e,this.isFocused=!1},a=function(e){c.call(this,e),this.type="checkbox"},o=function(e){c.call(this,e),this.type="radio"},r=function(e){c.call(this,e),this.type="select"};c.prototype={init:function(){var e=this;e.fancify(),e.el.addClass("hidden").after(e.fel),e.bindEvents()},fancify:function(){var t=this;t.fel=e(e.parseHTML(l("<div class='fancy {0}{1}{2}'></div>",t.type,t.isDisabled()?" disabled":"",t.isSelected()?" selected":"")))},isSelected:function(){return this.el.is(":checked")},isDisabled:function(){return this.el.prop("disabled")},focus:function(){this.fel.addClass("focused")},blur:function(){this.fel.removeClass("focused")},syncChange:function(){var e=this;e.isSelected()?e.fel.addClass("selected"):e.fel.removeClass("selected")},changeValue:function(){var e=this;if(!e.isDisabled()){var t=e.el.get(0);e.el.trigger("focus"),t.checked=!t.checked,e.el.trigger("change")}},bindEvents:function(){this.nativeEvents(),this.fancyEvents()},nativeEvents:function(){var e=this;e.el.on("focus",function(){e.blurTimer===i?e.focus():clearTimeout(e.blurTimer)}),e.el.on("blur",function(){e.blurTimer=setTimeout(function(){delete e.blurTimer,e.blur()},150)}),e.el.on("change",function(){e.syncChange()})},fancyEvents:function(){var e=this;e.fel.on("click",function(){e.changeValue()})}},e.inherit(a,c),e.inherit(o,c,{getGroup:function(){return e(l("input:radio[name='{0}']",this.el.attr("name")))},syncChange:function(){this.getGroup().next().removeClass("selected"),this.fel.addClass("selected")},changeValue:function(){var e=this;e.el.trigger("focus"),e.getGroup().attr("checked",!1),e.el.get(0).checked=!0,e.el.trigger("change")}}),e.inherit(r,c,{init:function(){var e=this;e.fancify(),e.el.addClass("hidden").after(e.fel).attr("size",e.el.find("option").size()),e.bindEvents()},fancify:function(){var t=this,n=l("<div class='fancy {0}{1}'>",t.type,t.isDisabled()?" disabled":"");n+=l("<span class='selected-value'>{0}</span><ul class='options'>",t.el.find(l("option[value='{0}']",t.el.val())).text()),t.el.children().each(function(){switch(this.tagName.toLowerCase()){case"option":n+=t.getOption(e(this));break;case"optgroup":var i=e(this),s=i.attr("label");n+=l("<li class='group{0}'><span class='group-label'>{1}</span><ul>",i.prop("disabled")?" disabled":"",s?s:"&nbsp;"),i.children().each(function(){n+=t.getOption(e(this))}),n+="</ul></li>"}}),n+="</ul></div>",t.fel=e(e.parseHTML(n))},getOption:function(e){return l("<li class='option{0}{1}'>{2}</li>",e.prop("disabled")?" disabled":"",e.val()===this.el.val()?" selected":"",e.text())},isOpen:function(){return this.fel.hasClass("open")},blur:function(){this.close(),this.fel.removeClass("focused")},syncChange:function(){var e=this,t=e.el.find(l("option[value='{0}']",e.el.val())).text();e.fel.children(".selected-value").text(t),e.fel.find(".option").removeClass("selected").filter(l(":contains('{0}')",t)).addClass("selected")},changeValue:function(e){this.el.val(e).trigger("change")},open:function(){this.fel.addClass("open")},close:function(){this.fel.removeClass("open")},fancyEvents:function(){var t=this;t.el.on("keydown",function(e){(e.which===s.ESC||e.which===s.ENTER)&&t.close()}),t.fel.on("click",function(){t.isDisabled()||t.el.trigger("focus")}),t.fel.on("click",".selected-value",function(){t.isDisabled()||(t.isOpen()?t.close():t.open())}),t.fel.on("click",".option",function(){var n=e(this);n.hasClass("disabled")||0!==n.parents(".group.disabled").length||(t.changeValue(t.el.find(l("option:contains('{0}')",n.text())).val()),t.close())})}}),e.fn.extend({fancifyCheckbox:function(){return this.filter("input:checkbox").each(function(){new a(e(this)).init()})},fancifyRadio:function(){return this.filter("input:radio").each(function(){new o(e(this)).init()})},fancifySelect:function(){return this.filter("select").each(function(){new r(e(this)).init()})}})}(jQuery,Object,Array);